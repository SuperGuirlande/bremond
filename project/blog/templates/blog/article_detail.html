{% extends 'main/base.html' %}
{% load static %}

{% block title %}Les Articles - Bremond Rénovation{% endblock %}

{% block extra_head %}
<style>
    .ck-content {
        font-family: "Raleway", sans-serif;
        color: var(--charbon);
        line-height: 1.8;
    }    
    
    .ck-content h1 {
        font-size: clamp(2rem, 5vw, 3rem);
        color: var(--charbon);
        margin: 2rem 0 1rem;
    }
    
    .ck-content h2 {
        font-size: clamp(1.75rem, 4vw, 2.5rem);
        color: var(--granit) !important;
        margin: 1.75rem 0 1rem;
    }

    .ck-content h3 {
        color: var(--granit);
        font-size: clamp(1.5rem, 3vw, 2rem);
        margin: 1.5rem 0 1rem;
    }

    .ck-content h1, .ck-content h2, .ck-content h3 {
        font-family: "Playfair Display", serif;
        line-height: 1.3;
    }

    .ck-content p {
        margin-bottom: 1.25rem;
    }

    .ck-editor__editable {
        height: 700px;
    }

    .ck-content img {
        max-height: 500px; /* Réduit de 500px à 300px */
        max-width: 100%;
        width: auto;
        margin: 1.5rem auto; /* Centrage horizontal */
        object-fit: contain; /* Changed from cover to contain */
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        display: block; /* Pour assurer le centrage */
    }

    .article-meta {
        display: inline-flex;
        align-items: center;
        padding: 0.5rem 1rem;
        background-color: rgba(var(--granit-rgb), 0.05);
        border-radius: 2rem;
        font-size: 0.875rem;
    }

    .article-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border-radius: 1rem;
        overflow: hidden;
    }

    .article-card:hover {
        transform: translateY(-0.5rem);
        box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1);
    }
</style>
{% endblock %}

{% block content %}
<section class="mt-16 lg:mt-28 w-full py-16 bg-blanc flex flex-col z-[2] shadow-lg">
    <article class="w-full max-w-[1180px] mx-auto bg-white px-4 sm:px-8 lg:px-16 py-12 lg:py-20 shadow-xl rounded-2xl">
        <!-- Article Header -->
        <header class="space-y-8">
            <div class="flex flex-wrap gap-4 justify-between">
                <span class="article-meta">
                    {% for cat in article.categories.all %}
                        {{cat.title}}{% if not forloop.last %} • {% endif %}
                    {% endfor %}
                </span>
                <time class="article-meta">
                    {{article.created_on|date:"d F Y"}}
                </time>
            </div>
            
            <h1 class="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl text-left playfair terre drop-shadow-lg">
                {{article.title}}
            </h1>
        </header>

        <div class="mt-12 lg:mt-16 flex flex-col lg:flex-row gap-8 lg:gap-16 items-center">
            <div class="lg:basis-[40%] h-[300px] overflow-hidden rounded-xl shadow-lg"> 
                <img 
                    src="{{article.thumbnail.url}}" 
                    alt="{{article.title}}" 
                    class="w-full h-full object-cover object-center transition-transform duration-700 hover:scale-105"
                >
            </div>
            <div class="lg:basis-3/4"> 
                <p class="raleway text-justify leading-relaxed text-lg lg:text-xl tracking-wide text-slate-700">
                    {{article.introduction}}
                </p>
            </div>
        </div>

        <!-- Article Content -->
        <div class="ck-content mt-16 prose max-w-none">
            {{article.content|safe}}
        </div>
    </article>
</section>

<!-- Related Articles -->
<section class="w-full py-16 bg-blanc flex flex-col z-[2] shadow-lg">
    <div class="w-full max-w-[1180px] mx-auto px-4 sm:px-8">
        <h2 class="text-3xl md:text-4xl lg:text-5xl petit drop-shadow-md granit text-center mb-12">
            Des articles qui pourraient vous plaire
        </h2>
        
        <div class="grid sm:grid-cols-2 gap-8">
            {% for art in next_articles %}
            <a href="{% url 'article_detail' art.slug %}" class="article-card bg-white">
                <div class="p-6 lg:p-8 h-full flex flex-col">
                    <div class="flex gap-2 flex-wrap mb-4">
                        {% for cat in art.categories.all %}
                        <span class="text-sm text-slate-500 bg-slate-50 px-3 py-1 rounded-full">
                            {{cat.title}}
                        </span>
                        {% endfor %}
                    </div>
                    
                    <h3 class="charbon text-xl sm:text-2xl lg:text-3xl raleway font-semibold mb-4">
                        {{art.title}}
                    </h3>
                    
                    <p class="raleway text-slate-700 mb-6 line-clamp-3 mt-auto">
                        {{art.introduction}}
                    </p>
                    
                    <div class="flex justify-between items-center mt-auto pt-4 border-t border-slate-100">
                        <time class="text-sm text-slate-500">
                            {{art.created_on|date:"d F Y"}}
                        </time>
                        <span class="text-blue-500 font-medium group-hover:translate-x-2 transition-transform">
                            Lire l'article →
                        </span>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}